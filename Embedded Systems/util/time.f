\ include se-ans.f

\ FILE PER DIMOSTRARE I TEMPI DI ESECUZIONE PER CARICARE IMMAGINI CON TRE DIVERSI METODI

HEX

3F003004 CONSTANT SYSTCLO
1E8FA000 CONSTANT FRAMEBUFFER
00200000 CONSTANT STARTBG

VARIABLE TIME

: 3DUP DUP 2OVER ROT ;

\ Calcola il tempo passato, in microsecondi, tra due diverse letture del registro SYSTCLO.
: TIMEPASSED SWAP - ;

\ TEMPO (microsecondi) DELAYMS 
: DELAYMS SYSTCLO @ BEGIN 2DUP SYSTCLO @ TIMEPASSED <= UNTIL 2DROP ;



\ METODO 1 --> LOOP IN FORTH -- LOADFORTH

HEX
VARIABLE COUNTER 
C0000 COUNTER !
: LOADBG STARTBG DUP @ FRAMEBUFFER 3DUP ! DROP BEGIN 4 + SWAP DROP SWAP 4 + DUP @ ROT 3DUP ! DROP COUNTER @ 1 - DUP COUNTER ! 0 = UNTIL DROP 2DROP ;
: LOADFORTH HEX SYSTCLO @ LOADBG SYSTCLO @ TIMEPASSED TIME ! DECIMAL TIME @ . C0000 COUNTER ! ; 

\ 17,27 SECONDI 


\ METODO 2 --> WORD BUILT-IN DI FORTH CMOVE -- LOADCMOVE

: LOADCMOVE HEX SYSTCLO @ 00200000 1E8FA000 300000 CMOVE SYSTCLO @ TIMEPASSED TIME ! DECIMAL TIME @ . ; 

\ 0,846 SECONDI



\ METODO 3 --> ROUTINE ASSEMBLY CREATA ALLO SCOPO -- LOADASSEMBLY

HEX
\ WORD PER CARICARE IL BACKGROUND (loadBG.s)
CREATE  BG 
e49d5004 , e49d0004 ,
e49d2004 , e5921000 ,
e5801000 , e3550000 ,
0a000005 , e2822004 ,
e5921000 , e2800004 ,
e5801000 , e2455001 ,
eafffff7 , e12fff1e ,
: BACKGROUND STARTBG FRAMEBUFFER C0000 BG JSR DROP ;
: LOADASSEMBLY HEX SYSTCLO @ BACKGROUND SYSTCLO @ TIMEPASSED TIME ! DECIMAL TIME @ . ; 

\ 0,212 SECONDI 














